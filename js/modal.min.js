/**
 * @name modal.js v1.0
 * @author Jean Ehrhardt
 * https://github.com/Houdouh/modal.js
 * A really simple, light, efficient, and usefull modal plugin
 */
!function(){var t=0,o="",e=null,n=!0,i=!1,s=null,l=/^[a-z0-9]+[\w-]*$/i,a='<header class="modal-title"><p></p></header><div class="modal-content"></div>',r=[];this.Modal=function(e){this.options={},this.dom={},t++,o="modal"+t,this.options.addCloseBtn=!0,this.options.attributes={},this.options.autoOpen=!1,this.options.closeByOverlay=!0,this.options.closeBtn="&#10006",this.options.closeBtnClass="",this.options.content="",this.options.customClass="",this.options.escapeClose=!0,this.options.headerFixed=!0,this.options.height=null,this.options.id=o,this.options.responsive=!0,this.options.responsiveBrink=50,this.options.template=a,this.options.title="",this.options.transition="fade",this.options.transitionDuration=400,this.options.width=null,"object"==typeof e&&d(e,this.options),r.push(this),r.length>1&&c(),null!=s&&(p(this.dom,this.options),u.call(this))},Modal.prototype.open=function(t){if(!i){var o=document.getElementById(this.options.id);n=!1,e.style.transitionDuration=this.options.transitionDuration+"ms";var s={modal:this,target:t},l=document.createEvent("CustomEvent"),a=document.createEvent("CustomEvent");if(l.initCustomEvent("beforeOpen",!1,!1,s),a.initCustomEvent("open",!1,!1,s),setTimeout(function(){o.dispatchEvent(l)},0),e.className="show",this.dom.id.style.display="block",this.options.responsive&&null!=this.options.width){var r=screen.width-this.options.responsiveBrink,d=this.options.width,c=r<=o.offsetWidth,h=r>o.offsetWidth&&o.offsetWidth<d;(c||h)&&(o.style.width=(r>d?d:r)+"px")}setTimeout(function(){o.dispatchEvent(a),n=!0},this.options.transitionDuration)}},Modal.prototype.close=function(){if(n){var t=this,o=document.getElementById(this.options.id);i=!0;var s={modal:t},l=document.createEvent("CustomEvent"),a=document.createEvent("CustomEvent");l.initCustomEvent("beforeClose",!1,!1,s),a.initCustomEvent("closed",!1,!1,s),setTimeout(function(){o.dispatchEvent(l)},0),e.className="",o.className+=" close",setTimeout(function(){o.className=o.className.replace(new RegExp("(^|\\b)"+"close".split(" ").join("|")+"(\\b|$)","gi")," "),o.style.display="none",o.dispatchEvent(a)},this.options.transitionDuration),setTimeout(function(){i=!1},this.options.transitionDuration>=600?this.options.transitionDuration:600)}},Modal.prototype.destroy=function(){for(var t=document.getElementById(this.options.id),o=0,e=r.length;e>o;o++)if(r[o].options.id==this.options.id){r.splice(o,1);break}setTimeout(function(){t.parentNode.removeChild(t)},this.options.transitionDuration)},Modal.prototype.setCloseByOverlay=function(t){if("boolean"!=typeof t)throw new Error("(Modal.js) The param needs to be a boolean.");this.options.closeByOverlay=t},Modal.prototype.setContent=function(t){var o=document.querySelector("#"+this.options.id+" .modal-content");if(null==o)throw new Error('(Modal.js) Your modal doesn\'t contains any "modal-content" class.');this.options.content=t,o.innerHTML=t},Modal.prototype.setSize=function(t,o){var e=document.getElementById(this.options.id);this.options.height=t,this.options.width=o,null!=t?e.style.height=t+"px":e.style.height="",null!=o?e.style.width=o+"px":e.style.width=""},Modal.prototype.setId=function(t){var o=document.getElementById(this.options.id);if("string"!=typeof t)throw new Error("(Modal.js) Your id must be a string.");this.options.id=t,o.id=t,c()},Modal.prototype.setTemplate=function(t){var o=document.getElementById(this.options.id);this.options.template=t,o.innerHTML=t;var e=o.querySelector(".modal-title p"),n=o.querySelector(".modal-content");null!=e&&""!=this.options.title&&(e.innerHTML=this.options.title),null!=n&&""!=this.options.content&&(n.innerHTML=this.options.content),this.options.addCloseBtn&&(h(this.options,o),this.dom.closeBtn=o.querySelector(".modal-mainClose"),u.call(this))},Modal.prototype.setTitle=function(t){var o=document.querySelector("#"+this.options.id+" .modal-title p");if(null==o)throw new Error('(Modal.js) Your modal doesn\'t contains any "modal-title" class with a <p> tag.');this.options.title=t,o.innerHTML=t},Modal.prototype.setTransition=function(t){var o=document.getElementById(this.options.id);this.options.transition=t,o.setAttribute("data-transition",t)};var d=function(t,o){var e;for(e in t)o.hasOwnProperty(e)&&(o[e]=t[e]);return o},c=function(){for(var t=[],o=null,e=0,n=r.length;n>e;e++){if(o=r[e].options.id,t.indexOf(o)>=0)throw new Error("(Modal.js) There is twice same id. There can be only unique id.");t.push(o)}},h=function(t,o){var e=o.querySelector(".modal-title"),n=document.createElement("span");if(closeBtn=null,null!=e?closeBtn=e.appendChild(n):(closeBtn=o.appendChild(n),o.insertBefore(closeBtn,o.firstChild)),closeBtn.className="modal-mainClose",""!=t.closeBtnClass)for(var i=t.closeBtnClass.split(" "),s=0,a=i.length;a>s;s++){if(!l.test(i[s]))throw new Error("(Modal.js) An invalid custom class has been specified.");closeBtn.className+=" "+i[s]}closeBtn.innerHTML=t.closeBtn},p=function(t,o){if(null==e){var n=document.createElement("div");n.id="modalBackground",s.appendChild(n),s.insertBefore(n,s.firstChild),e=document.getElementById("modalBackground")}var i=document.createElement("div");if(i.id=o.id,i.className="modal",""!=o.customClass)for(var a=o.customClass.split(" "),r=0,d=a.length;d>r;r++){if(!l.test(a[r]))throw new Error("(Modal.js) An invalid custom class has been specified.");i.className+=" "+a[r]}i.innerHTML=o.template;var c=i.querySelector(".modal-title"),p=i.querySelector(".modal-content");if(c&&o.headerFixed&&(i.className+=" fixed"),o.addCloseBtn&&h(o,i),!c&&""!=o.title)throw new Error('(Modal.js) Your template doesn\'t match the model. If you want to set a title, please add a "modal-title" class with a <p> inside.');if(!p&&""!=o.content)throw new Error('(Modal.js) Your template doesn\'t match the model. If you want to set a content, please add a "modal-content" class to your container.');if(""!=o.title&&(c.querySelector("p").innerHTML=o.title),""!=o.content&&(p.innerHTML=o.content),null!=o.height&&(i.style.height=o.height+"px"),null!=o.width&&(i.style.width=o.width+"px",o.width<250&&(i.style.minWidth=o.width+"px")),i.style.animationDuration=o.transitionDuration+"ms","donna"==o.transition)for(var u=i.childNodes,r=0,d=u.length;d>r;r++)u[r].style.animationDuration=o.transitionDuration+"ms";i.setAttribute("data-transition",o.transition);var m;for(m in o.attributes)i.setAttribute("data-"+m,o.attributes[m]);e.appendChild(i),t.id=document.getElementById(i.id),o.addCloseBtn&&(t.closeBtn=closeBtn)},u=function(){this.options.addCloseBtn&&this.dom.closeBtn.addEventListener("click",this.close.bind(this))},m=function(t){modals=document.querySelectorAll("#modalBackground .modal");for(var o=0,e=modals.length;e>o;o++)if("block"==modals[o].style.display){var n=f(modals[o].id);if(n.options.responsive&&null!=n.options.width){var i=screen.width-n.options.responsiveBrink,s=i<=modals[o].offsetWidth,l=i>modals[o].offsetWidth&&modals[o].offsetWidth<n.options.width;(s||l)&&(modals[o].style.width=i+"px")}break}},f=function(t){for(var o=null,e=0,n=r.length;n>e;e++)if(r[e].options.id===t){o=r[e];break}if(null==o)throw new Error("(Modal.js) The according modal instance no longer exists.");return o},y=function(){s=document.body;var t,o,n=null,i=function(e){if(t=e.target,o=t.getAttribute("data-modal")){var n=f(o);n.open(t)}},l=function(o){if(t=o.target,"modalBackground"===t.id){n=document.querySelectorAll("#modalBackground .modal");for(var e=0,i=n.length;i>e;e++)if("block"==n[e].style.display){var s=f(n[e].id);s.options.closeByOverlay&&s.close();break}}},a=function(o){if(t=o.target,"modal-close"===t.className){n=document.querySelectorAll("#modalBackground .modal");for(var e=0,i=n.length;i>e;e++)if("block"==n[e].style.display){var s=f(n[e].id);s.close();break}}},d=function(){n=document.querySelectorAll("#modalBackground .modal");for(var t=0,o=n.length;o>t;t++)if("block"==n[t].style.display){var e=f(n[t].id);e.options.escapeClose&&e.close();break}};s.addEventListener("click",function(t){i(t),a(t),new RegExp("(^| )show( |$)","gi").test(e.className)&&l(t)}),document.addEventListener("keydown",function(t){new RegExp("(^| )show( |$)","gi").test(e.className)&&27==t.keyCode&&d()}),window.addEventListener("resize",function(){new RegExp("(^| )show( |$)","gi").test(e.className)&&m()});for(var c=null,h=0,y=r.length;y>h;h++)c=r[h],p(c.dom,c.options),u.call(c),c.options.autoOpen&&c.open()};document.onreadystatechange=function(){"interactive"==document.readyState&&y()}}();